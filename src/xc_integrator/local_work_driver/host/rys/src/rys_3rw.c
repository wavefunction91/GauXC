#include <stdio.h>
#include <stdlib.h>
#include <assert.h>
#include <math.h>

#define MAX(a,b)    ((a) < (b) ? (b) : (a))
#define MIN(a,b)    ((a) > (b) ? (b) : (a))

void rys_3rw(int nt, const double tval[restrict], double rts[restrict], double wts[restrict]) {
  int jump3[48] =
    { 1, 2, 2, 3, 3, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 7, 7,
      7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8,
      8, 8, 9
    };

  double e;
  int m, n;
  double t, x, y, z__, a1, a2, f1, f2, r1, r2, r3, t1, t2, t3,
    w1, w2, w3;
  int tcase;

  m = 0;
  for (n = 0; n < nt; ++n) {
    t = tval[n];
    if (t <= 3e-7) {
      r1 = .0603769246832797 - t * .00928875764357368;
      r2 = .776823355931043 - t * .119511285527878;
      r3 = 6.66279971938567 - t * 1.02504611068957;
      wts[m] *= .467913934572691 - t * .0564876917232519;
      wts[m + 1] *= .360761573048137 - t * .149077186455208;
      wts[m + 2] *= .171324492379169 - t * .127768455150979;
      rts[m] = r1 / (r1 + 1.);
      rts[m + 1] = r2 / (r2 + 1.);
      rts[m + 2] = r3 / (r3 + 1.);
      m += 3;
      goto L300;
    }
        
    tcase = (int) MIN ((t + 1.0), 48.0);
    switch (jump3[tcase - 1])
      {
      case 1:
	goto L3100;
      case 2:
	goto L3200;
      case 3:
	goto L3300;
      case 4:
	goto L3400;
      case 5:
	goto L3500;
      case 6:
	goto L3600;
      case 7:
	goto L3700;
      case 8:
	goto L3800;
      case 9:
	goto L3900;
      }

  L3100:
    e = exp (-t);
    f2 = ((((((((t * -7.6091148609885e-8 + 1.09552870123182e-6) * t -
		1.03463270693454e-5) * t + 8.16324851790106e-5) * t -
	      5.55526624875562e-4) * t + .00320512054753924) * t -
	    .015151513983854) * t + .0555555554649585) * t -
	  .142857142854412) * t + .199999999999986;
    f1 = ((t + t) * f2 + e) * .333333333333333;
    w1 = (t + t) * f1 + e;
    r1 = ((((((t * -5.1018669153887e-10 + 2.4013441570345e-8) * t -
	      5.01081057744427e-7) * t + 7.58291285499256e-6) * t -
	    9.55085533670919e-5) * t + .00102893039315878) * t -
	  .00928875764374337) * t + .060376924683281;
    r2 = ((((((t * -1.29646524960555e-8 + 7.74602292865683e-8) * t +
	      1.56022811158727e-6) * t - 1.58051990661661e-5) * t -
	    3.30447806384059e-4) * t + .00974266885190267) * t -
	  .119511285526388) * t + .776823355931033;
    r3 = ((((((t * -9.28536484109606e-9 - 3.02786290067014e-7) * t -
	      2.507344770642e-6) * t - 7.32728109752881e-6) * t +
	    2.44217481700129e-4) * t + .0494758452357327) * t -
	  1.02504611065774) * t + 6.66279971938553;
    t1 = r1 / (r1 + 1.);
    t2 = r2 / (r2 + 1.);
    t3 = r3 / (r3 + 1.);
    a1 = f1 - t1 * w1;
    a2 = f2 - t1 * f1;
    w2 = (t3 * a1 - a2) / ((t3 - t2) * (t2 - t1));
    w3 = (a2 - t2 * a1) / ((t3 - t2) * (t3 - t1));
    wts[m] *= w1 - w2 - w3;
    wts[m + 1] *= w2;
    wts[m + 2] *= w3;
    rts[m] = t1;
    rts[m + 1] = t2;
    rts[m + 2] = t3;
    m += 3;
    goto L300;

  L3200:
    e = exp (-t);
    x = t - 2.;
    f2 = ((((((((((x * -1.4804423107214e-10 + 1.78157031325097e-9) * x -
		  1.92514145088973e-8) * x + 1.92804632038796e-7) * x -
		1.73806555021045e-6) * x + 1.39195169625425e-5) * x -
	      9.74574633246452e-5) * x + 5.83701488646511e-4) * x -
	    .00289955494844975) * x + .011384700111381) * x -
	  .0323446977320647) * x + .0529428148329709;
    f1 = ((t + t) * f2 + e) * .333333333333333;
    w1 = (t + t) * f1 + e;
    r1 = ((((((((x * 1.44687969563318e-12 + 4.85300143926755e-12) * x -
		6.55098264095516e-10) * x + 1.56592951656828e-8) * x -
	      2.60122498274734e-7) * x + 3.86118485517386e-6) * x -
	    5.13430986707889e-5) * x + 6.03194524398109e-4) * x -
	  .0061121934982509) * x + .0452578254679079;
    r2 = (((((((x * 6.95964248788138e-10 - 5.35281831445517e-9) * x -
	       6.745205954533e-8) * x + 1.502366784525e-6) * x +
	     9.923326947376e-7) * x - 3.89147469249594e-4) * x +
	   .00751549330892401) * x - .08487781203634) * x +
      .573928229597613;
    r3 = ((((((((x * -2.81496588401439e-10 + 3.61058041895031e-9) * x +
		4.53631789436255e-8) * x - 1.40971837780847e-7) * x -
	      6.05865557561067e-6) * x - 5.15964042227127e-5) * x +
	    3.34761560498171e-5) * x + .0504871005319119) * x -
	  .824708946991557) * x + 4.81234667357205;
    t1 = r1 / (r1 + 1.);
    t2 = r2 / (r2 + 1.);
    t3 = r3 / (r3 + 1.);
    a1 = f1 - t1 * w1;
    a2 = f2 - t1 * f1;
    w2 = (t3 * a1 - a2) / ((t3 - t2) * (t2 - t1));
    w3 = (a2 - t2 * a1) / ((t3 - t2) * (t3 - t1));
    wts[m] *= w1 - w2 - w3;
    wts[m + 1] *= w2;
    wts[m + 2] *= w3;
    rts[m] = t1;
    rts[m + 1] = t2;
    rts[m + 2] = t3;
    m += 3;
    goto L300;

  L3300:
    e = exp (-t);
    x = t - 4.;
    f2 = ((((((((((x * -2.36788772599074e-11 + 2.89147476459092e-10) * x
		  - 3.18111322308846e-9) * x + 3.25336816562485e-8) * x -
		3.00873821471489e-7) * x + 2.48749160874431e-6) * x -
	      1.81353179793672e-5) * x + 1.14504948737066e-4) * x -
	    6.10614987696677e-4) * x + .00264584212770942) * x -
	  .00866415899015349) * x + .0175257821619922;
    f1 = ((t + t) * f2 + e) * .333333333333333;
    w1 = (t + t) * f1 + e;
    r1 = (((((((x * 1.44265709189601e-11 - 4.66622033006074e-10) * x +
	       7.649155832025e-9) * x - 1.229940017368e-7) * x +
	     2.026002142457e-6) * x - 2.87048671521677e-5) * x +
	   3.70326938096287e-4) * x - .00421006346373634) * x +
      .0350898470729044;
    r2 = ((((((((x * -2.65526039155651e-11 + 1.97549041402552e-10) * x +
		2.15971131403034e-9) * x - 7.95045680685193e-8) * x +
	      5.15021914287057e-7) * x + 1.11788717230514e-5) * x -
	    3.33739312603632e-4) * x + .00530601428208358) * x -
	  .0593483267268959) * x + .431180523260239;
    r3 = ((((((((x * -3.92833750584041e-10 - 4.1642322978228e-9) * x +
		4.42413039572867e-8) * x + 6.40574545989551e-7) * x -
	      3.05512456576552e-6) * x - 1.05296443527943e-4) * x -
	    6.14120969315617e-4) * x + .0489665802767005) * x -
	  .624498381002855) * x + 3.36412312243724;
    t1 = r1 / (r1 + 1.);
    t2 = r2 / (r2 + 1.);
    t3 = r3 / (r3 + 1.);
    a1 = f1 - t1 * w1;
    a2 = f2 - t1 * f1;
    w2 = (t3 * a1 - a2) / ((t3 - t2) * (t2 - t1));
    w3 = (a2 - t2 * a1) / ((t3 - t2) * (t3 - t1));
    wts[m] *= w1 - w2 - w3;
    wts[m + 1] *= w2;
    wts[m + 2] *= w3;
    rts[m] = t1;
    rts[m + 1] = t2;
    rts[m + 2] = t3;
    m += 3;
    goto L300;

  L3400:
    e = exp (-t);
    x = 1. / t;
    y = t - 7.5;
    z__ = x * .5;
    w1 = ((((((x * .46897511375022 - .69955602298985) * x +
	      .53689283271887) * x - .32883030418398) * x +
	    .24645596956002) * x - .49984072848436) * x -
	  3.1501078774085e-6) * e + sqrt (x * .785398163397448);
    f1 = (w1 - e) * z__;
    f2 = (f1 + f1 + f1 - e) * z__;
    r1 = (((((((((((y * 5.74429401360115e-16 + 7.11884203790984e-16) * y
		   - 6.736701449826e-14) * y - 6.264613873998e-13) * y +
		 1.31541892704e-11) * y - 4.23879635610964e-11) * y +
	       1.39032379769474e-9) * y - 4.65449552856856e-8) * y +
	     7.34609900170759e-7) * y - 1.08656008854077e-5) * y +
	   1.77930381549953e-4) * y - .00239864911618015) * y +
      .0239112249488821;
    r2 = (((((((((((y * 1.1346409620912e-14 + 6.99375313934242e-15) * y -
		   8.595618132088e-13) * y - 5.293620408757e-12) * y -
		 2.492175211635e-11) * y + 2.73681574882729e-9) * y -
	       1.06656985608482e-8) * y - 4.40252529648056e-7) * y +
	     9.68100917793911e-6) * y - 1.68211091755327e-4) * y +
	   .00269443611274173) * y - .0323845035189063) * y +
      .275969447451882;
    r3 = ((((((((((((y * 6.66339416996191e-15 + 1.84955640200794e-13) * y
		    - 1.985141104444e-12) * y - 2.309293727603e-11) * y +
		  3.917984522103e-10) * y + 1.663165279876e-9) * y -
		6.205591993923e-8) * y + 8.769581622041e-9) * y +
	      8.97224398620038e-6) * y - 3.14232666170796e-5) * y -
	    .00183917335649633) * y + .0351246831672571) * y -
	  .32233505127086) * y + 1.7358283175543;
    t1 = r1 / (r1 + 1.);
    t2 = r2 / (r2 + 1.);
    t3 = r3 / (r3 + 1.);
    a1 = f1 - t1 * w1;
    a2 = f2 - t1 * f1;
    w2 = (t3 * a1 - a2) / ((t3 - t2) * (t2 - t1));
    w3 = (a2 - t2 * a1) / ((t3 - t2) * (t3 - t1));
    wts[m] *= w1 - w2 - w3;
    wts[m + 1] *= w2;
    wts[m + 2] *= w3;
    rts[m] = t1;
    rts[m + 1] = t2;
    rts[m + 2] = t3;
    m += 3;
    goto L300;

  L3500:
    e = exp (-t);
    x = 1. / t;
    y = t - 12.5;
    z__ = x * .5;
    w1 = (((x * -.18784686463512 + .22991849164985) * x - .49893752514047)
	  * x - 2.1916512131607e-5) * e + sqrt (x * .785398163397448);
    f1 = (w1 - e) * z__;
    f2 = (f1 + f1 + f1 - e) * z__;
    r1 = (((((((((((y * 4.4213300128309e-16 - 2.77189767070441e-15) * y -
		   4.084026087887e-14) * y + 5.379885121517e-13) * y +
		 1.882093066702e-12) * y - 8.67286219861085e-11) * y +
	       7.11372337079797e-10) * y - 3.55578027040563e-9) * y +
	     1.29454702851936e-7) * y - 4.14222202791434e-6) * y +
	   8.04427643593792e-5) * y - .00118587782909876) * y +
      .0153435577063174;
    r2 = (((((((((((y * 6.85146742119357e-15 - 1.08257654410279e-14) * y
		   - 8.579165965128e-13) * y + 6.642452485783e-12) * y +
		 4.798806828724e-11) * y - 1.13413908163831e-9) * y +
	       7.08558457182751e-9) * y - 5.59678576054633e-8) * y +
	     2.51020389884249e-6) * y - 6.63678914608681e-5) * y +
	   .00111888323089714) * y - .0145361636398178) * y +
      .165077877454402;
    r3 = ((((((((((((y * 3.20622388697743e-15 - 2.73458804864628e-14) * y
		    - 3.157134329361e-13) * y + 8.654129268056e-12) * y -
		  5.625235879301e-11) * y - 7.718080513708e-10) * y +
		2.064664199164e-8) * y - 1.567725007761e-7) * y -
	      1.57938204115055e-6) * y + 6.27436306915967e-5) * y -
	    .00101308723606946) * y + .0113901881430697) * y -
	  .10144965289945) * y + .777203937334739;
    t1 = r1 / (r1 + 1.);
    t2 = r2 / (r2 + 1.);
    t3 = r3 / (r3 + 1.);
    a1 = f1 - t1 * w1;
    a2 = f2 - t1 * f1;
    w2 = (t3 * a1 - a2) / ((t3 - t2) * (t2 - t1));
    w3 = (a2 - t2 * a1) / ((t3 - t2) * (t3 - t1));
    wts[m] *= w1 - w2 - w3;
    wts[m + 1] *= w2;
    wts[m + 2] *= w3;
    rts[m] = t1;
    rts[m + 1] = t2;
    rts[m + 2] = t3;
    m += 3;
    goto L300;

  L3600:
    e = exp (-t);
    x = 1. / t;
    z__ = x * .5;
    w1 = ((x * .1962326414943 - .4969524146449) * x - 6.0156581186481e-5)
      * e + sqrt (x * .785398163397448);
    f1 = (w1 - e) * z__;
    f2 = (f1 + f1 + f1 - e) * z__;
    r1 = ((((((t * -2.43270989903742e-6 + 3.57901398988359e-4) * t -
	      .0234112415981143) * t + .781425144913975) * t -
	    17.3209218219175) * t + 243.517435690398) * t + (x *
							     -19761.1541576986
							     +
							     9824.41363463929)
	  * x - 2079.70687843258) * e + .190163509193487 / (t -
							    .190163509193487);
    r2 = (((((t * -2.62627010965435e-4 + .0349187925428138) * t -
	     3.0933761873188) * t + 107.037141010778) * t -
	   2366.59637247087) * t + ((x * -2916691.1368102 +
				     1411295.05262758) * x -
				    291532.335433779) * x +
	  33520.2872835409) * e + 1.78449274854325 / (t -
						      1.78449274854325);
    r3 = (((((t * 9.31856404738601e-5 - .0287029400759565) * t -
	     .783503697918455) * t - 18.4338896480695) * t +
	   404.996712650414) * t + (x * -189829.509315154 +
				    51149.8390849158) * x -
	  6881.45821789955) * e + 5.52534374226326 / (t -
						      5.52534374226326);
    t1 = r1 / (r1 + 1.);
    t2 = r2 / (r2 + 1.);
    t3 = r3 / (r3 + 1.);
    a1 = f1 - t1 * w1;
    a2 = f2 - t1 * f1;
    w2 = (t3 * a1 - a2) / ((t3 - t2) * (t2 - t1));
    w3 = (a2 - t2 * a1) / ((t3 - t2) * (t3 - t1));
    wts[m] *= w1 - w2 - w3;
    wts[m + 1] *= w2;
    wts[m + 2] *= w3;
    rts[m] = t1;
    rts[m + 1] = t2;
    rts[m + 2] = t3;
    m += 3;
    goto L300;

  L3700:
    e = exp (-t);
    x = 1. / t;
    z__ = x * .5;
    w1 = ((x * .1962326414943 - .4969524146449) * x - 6.0156581186481e-5)
      * e + sqrt (x * .785398163397448);
    f1 = (w1 - e) * z__;
    f2 = (f1 + f1 + f1 - e) * z__;
    r1 = ((((t * -4.97561537069643e-4 - .0500929599665316) * t +
	    1.31099142238996) * t - 18.8336409225481) * t - x *
	  660.344754467191 + 164.931462413877) * e + .190163509193487 /
      (t - .190163509193487);
    r2 = ((((t * -.00448218898474906 - .517373211334924) * t +
	    11.3691058739678) * t - 165.426392885291) * t - x *
	  6309.09125686731 + 1522.31757709236) * e + 1.78449274854325 /
      (t - 1.78449274854325);
    r3 = ((((t * -.0138368602394293 - 1.77293428863008) * t +
	    17.3639054044562) * t - 357.615122086961) * t - x *
	  14573.4701095912 + 2698.31813951849) * e + 5.52534374226326 /
      (t - 5.52534374226326);
    t1 = r1 / (r1 + 1.);
    t2 = r2 / (r2 + 1.);
    t3 = r3 / (r3 + 1.);
    a1 = f1 - t1 * w1;
    a2 = f2 - t1 * f1;
    w2 = (t3 * a1 - a2) / ((t3 - t2) * (t2 - t1));
    w3 = (a2 - t2 * a1) / ((t3 - t2) * (t3 - t1));
    wts[m] *= w1 - w2 - w3;
    wts[m + 1] *= w2;
    wts[m + 2] *= w3;
    rts[m] = t1;
    rts[m + 1] = t2;
    rts[m + 2] = t3;
    m += 3;
    goto L300;

  L3800:
    e = exp (-t);
    w1 = sqrt (.785398163397448 / t);
    w2 = ((t * 61.5072615497811 - 2919.80647450269) * t +
	  38079.4303087338) * e + w1 * .177231492083829;
    w3 = (((t * .152258947224714 - 8.30661900042651) * t +
	   192.977367967984) * t - 1677.87926005344) * e + w1 *
      .00511156880411248;
    r1 = ((t * -7.39058467995275 + 321.318352526305) * t -
	  3994.33696473658) * e + .190163509193487 / (t -
						      .190163509193487);
    r2 = ((t * -73.8726243906513 + 3135.69966333873) * t -
	  38686.2867311321) * e + 1.78449274854325 / (t -
						      1.78449274854325);
    r3 = ((t * -263.750565461336 + 10441.2168692352) * t -
	  128094.577915394) * e + 5.52534374226326 / (t -
						      5.52534374226326);
    wts[m] *= w1 - w2 - w3;
    wts[m + 1] *= w2;
    wts[m + 2] *= w3;
    rts[m] = r1 / (r1 + 1.);
    rts[m + 1] = r2 / (r2 + 1.);
    rts[m + 2] = r3 / (r3 + 1.);
    m += 3;
    goto L300;

  L3900:
    w1 = sqrt (.785398163397448 / t);
    w2 = w1 * .177231492083829;
    w3 = w1 * .00511156880411248;
    wts[m] *= w1 - w2 - w3;
    wts[m + 1] *= w2;
    wts[m + 2] *= w3;
    rts[m] = .190163509193487 / t;
    rts[m + 1] = 1.78449274854325 / t;
    rts[m + 2] = 5.52534374226326 / t;
    m += 3;
  L300:
    ;
  }
}
